(function(){"use strict";function g(t,e,s){const o=e===0?0:t[e-1],n=t[e],r=e===s-1?0:t[e+1];return o<<2|n<<1|r}function u(t,e,s){const o=new Uint8Array(e);for(let n=0;n<e;n++){const r=g(t,n,e),l=s>>r&1;o[n]=l}return o}function a(t){let e=0;for(let s=0;s<t.length;s++)t[s]===1&&(e|=1<<s);return e}self.onmessage=t=>{const{type:e}=t.data;if(e==="init"){const{width:s,ruleset:o,initialState:n}=t.data,r=a(n);self.postMessage({type:"initialized",currentCells:Array.from(n),currentInteger:r})}else if(e==="step"){const{currentCells:s,width:o,ruleset:n}=t.data,r=u(s,o,n),l=a(r);self.postMessage({type:"stepped",nextCells:Array.from(r),nextInteger:l})}else if(e==="generate"){const{initialCells:s,width:o,ruleset:n,sequenceLength:r}=t.data;let l=s;const i=[],c=[];c.push(Array.from(l)),i.push(a(l));for(let f=0;f<r-1;f++)l=u(l,o,n),c.push(Array.from(l)),i.push(a(l));self.postMessage({type:"generated",generatedIntegers:i,generatedStates:c})}}})();
